{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard Recommandations - MovieRec{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-5">
        <div class="col-12">
            <div class="dashboard-header text-center py-5">
                <h1 class="dashboard-title display-4 fw-bold text-dark mb-3">
                    <i class="fas fa-chart-line me-3" style="color: #3b82f6;"></i>
                    Dashboard Analytics
                </h1>
                <p class="dashboard-subtitle" style="color: #334155 !important; font-weight: 600 !important; font-size: 1.25rem !important;">
                    Analysez vos préférences et découvrez comment notre système fonctionne
                </p>
            </div>
        </div>
    </div>

    <!-- Quick Stats Cards -->
    <div class="row mb-5" data-animation="fade-in-up">
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stats-card">
                <div class="stats-icon bg-primary">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="stats-content">
                    <h3 class="stats-number" data-counter="150">0</h3>
                    <p class="stats-label">Films vus</p>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stats-card">
                <div class="stats-icon bg-success">
                    <i class="fas fa-star"></i>
                </div>
                <div class="stats-content">
                    <h3 class="stats-number" data-counter="45">0</h3>
                    <p class="stats-label">Avis donnés</p>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stats-card">
                <div class="stats-icon bg-warning">
                    <i class="fas fa-bookmark"></i>
                </div>
                <div class="stats-content">
                    <h3 class="stats-number" data-counter="23">0</h3>
                    <p class="stats-label">Dans ma liste</p>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-4">
            <div class="stats-card">
                <div class="stats-icon bg-info">
                    <i class="fas fa-magic"></i>
                </div>
                <div class="stats-content">
                    <h3 class="stats-number" data-counter="89">0</h3>
                    <p class="stats-label">Recommandations</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Analytics Cards -->
    <div class="row mb-5">
        <div class="col-lg-6 col-md-12 mb-4">
            <div class="analytics-card">
                <div class="card-header">
                    <h4><i class="fas fa-chart-bar me-2"></i>Top Films d'Action</h4>
                    <p>Films d'action les plus populaires</p>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush" id="actionMovies">
                        <li class="list-group-item"><i class="fas fa-spinner fa-spin me-2"></i>Chargement...</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-lg-6 col-md-12 mb-4">
            <div class="analytics-card">
                <div class="card-header">
                    <h4><i class="fas fa-rocket me-2"></i>Films Sci-Fi Populaires</h4>
                    <p>Science-fiction tendance</p>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush" id="sciFiMovies">
                        <li class="list-group-item"><i class="fas fa-spinner fa-spin me-2"></i>Chargement...</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- More Analytics -->
    <div class="row mb-5">
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="insights-card">
                <div class="card-header">
                    <h4><i class="fas fa-fire me-2"></i>Tendances Populaires</h4>
                    <p>Ce qui cartonne actuellement</p>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush" id="popularMovies">
                        <li class="list-group-item"><i class="fas fa-spinner fa-spin me-2"></i>Chargement...</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="insights-card">
                <div class="card-header">
                    <h4><i class="fas fa-laugh me-2"></i>Comédies Tendance</h4>
                    <p>Pour se détendre</p>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush" id="comedyTrends">
                        <li class="list-group-item"><i class="fas fa-spinner fa-spin me-2"></i>Chargement...</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="insights-card">
                <div class="card-header">
                    <h4><i class="fas fa-crown me-2"></i>Réalisateurs Notables</h4>
                    <p>Les maîtres du cinéma</p>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush" id="topDirectors">
                        <li class="list-group-item"><i class="fas fa-spinner fa-spin me-2"></i>Chargement...</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
/* Enhanced Dashboard Styles for Better Contrast and Readability */

/* Cards and Stats */
.stats-card {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 1px solid #e2e8f0;
    border-radius: 1rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    position: relative;
    overflow: hidden;
}

.stats-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
}

.stats-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
}

.stats-content h3 {
    color: #0f172a !important;
    font-weight: 900 !important;
    font-size: 2.5rem !important;
    margin-bottom: 0.5rem;
}

.stats-content p {
    color: #64748b !important;
    font-weight: 600 !important;
    margin: 0;
    font-size: 0.9rem;
}

.stats-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    margin-bottom: 1rem;
}

.stats-icon.bg-primary {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stats-icon.bg-success {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stats-icon.bg-warning {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

.stats-icon.bg-info {
    background: linear-gradient(135deg, #06b6d4, #0891b2);
}

/* Analytics Cards */
.analytics-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 1rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    overflow: hidden;
}

.analytics-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}

.analytics-card .card-header {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    border-bottom: 2px solid #e2e8f0;
    padding: 1.5rem;
}

.analytics-card .card-header h4 {
    color: #0f172a !important;
    font-weight: 700 !important;
    margin-bottom: 0.5rem;
}

.analytics-card .card-header p {
    color: #64748b !important;
    margin: 0;
    font-size: 0.9rem;
}

.analytics-card .card-body {
    padding: 1.5rem;
}

/* Insights Cards */
.insights-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 1rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    overflow: hidden;
}

.insights-card .card-header {
    background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
    border-bottom: 2px solid #cbd5e0;
    padding: 1.25rem;
}

.insights-card .card-header h4 {
    color: #0f172a !important;
    font-weight: 700 !important;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
}

.insights-card .card-header p {
    color: #64748b !important;
    margin: 0;
    font-size: 0.85rem;
}

.insights-card .card-body {
    padding: 1.25rem;
}

/* Enhanced titles and headings */
.dashboard-title {
    background: linear-gradient(135deg, #0f172a 0%, #334155 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.dashboard-subtitle {
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* List group enhancements */
.list-group-item {
    border: none;
    padding: 0.75rem 1rem;
    color: #374151 !important;
    background: transparent;
    border-bottom: 1px solid #f3f4f6;
}

.list-group-item:hover {
    background: #f8fafc !important;
    color: #0f172a !important;
}

/* Animation for better UX */
.stats-card,
.analytics-card,
.insights-card {
    animation: fadeInUp 0.6s ease forwards;
    opacity: 0;
    transform: translateY(20px);
}

.stats-card:nth-child(1) { animation-delay: 0.1s; }
.stats-card:nth-child(2) { animation-delay: 0.2s; }
.stats-card:nth-child(3) { animation-delay: 0.3s; }
.stats-card:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Better focus states for accessibility */
.stats-card:focus-within,
.analytics-card:focus-within,
.insights-card:focus-within {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}

/* Responsive improvements */
@media (max-width: 768px) {
    .stats-content h3 {
        font-size: 2rem !important;
    }
    
    .dashboard-title {
        font-size: 2rem !important;
    }
    
    .analytics-card .card-header,
    .insights-card .card-header {
        padding: 1rem;
    }
    
    .analytics-card .card-body,
    .insights-card .card-body {
        padding: 1rem;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Counter animation
    const counters = document.querySelectorAll('.stats-number');
    counters.forEach(counter => {
        const target = parseInt(counter.getAttribute('data-counter'));
        let current = 0;
        const increment = target / 100;
        
        const updateCounter = () => {
            if (current < target) {
                current += increment;
                counter.textContent = Math.floor(current);
                requestAnimationFrame(updateCounter);
            } else {
                counter.textContent = target;
            }
        };
        
        // Start animation with delay
        setTimeout(updateCounter, 500);
    });
    
    // Load dashboard data
    loadDashboardData();
});

function loadDashboardData() {
    try {
        // Simulate data loading
        setTimeout(() => {
            populateActionMovies();
            populateSciFiMovies();
            populatePopularMovies();
            populateComedyTrends();
            populateTopDirectors();
        }, 1000);
    } catch (error) {
        console.error('Error loading dashboard data:', error);
        showErrorState();
    }
}

function populateActionMovies() {
    const actionMovies = [
        'Mad Max: Fury Road',
        'John Wick',
        'The Dark Knight',
        'Avengers: Endgame',
        'Mission: Impossible'
    ];
    
    populateList('actionMovies', actionMovies);
}

function populateSciFiMovies() {
    const sciFiMovies = [
        'Blade Runner 2049',
        'Interstellar',
        'The Matrix',
        'Inception',
        'Dune'
    ];
    
    populateList('sciFiMovies', sciFiMovies);
}

function populatePopularMovies() {
    const popularMovies = [
        'The Shawshank Redemption',
        'The Godfather',
        'Pulp Fiction',
        'The Dark Knight',
        'Schindler\'s List'
    ];
    
    populateList('popularMovies', popularMovies);
}

function populateComedyTrends() {
    const comedyTrends = [
        'The Grand Budapest Hotel',
        'Superbad',
        'The Hangover',
        'Anchorman',
        'Step Brothers'
    ];
    
    populateList('comedyTrends', comedyTrends);
}

function populateTopDirectors() {
    const topDirectors = [
        'Christopher Nolan',
        'Quentin Tarantino',
        'Martin Scorsese',
        'Steven Spielberg',
        'The Coen Brothers'
    ];
    
    populateList('topDirectors', topDirectors);
}

function populateList(listId, items) {
    const list = document.getElementById(listId);
    list.innerHTML = '';
    
    items.forEach((item, index) => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = `
            <span>${item}</span>
            <span class="badge bg-primary rounded-pill">${index + 1}</span>
        `;
        list.appendChild(li);
    });
}

function showErrorState() {
    const sections = ['actionMovies', 'sciFiMovies', 'popularMovies', 'comedyTrends', 'topDirectors'];
    sections.forEach(section => {
        const list = document.getElementById(section);
        list.innerHTML = '';
        const li = document.createElement('li');
        li.className = 'list-group-item text-danger';
        li.textContent = 'Error loading data';
        list.appendChild(li);
    });
}
</script>
{% endblock %}
